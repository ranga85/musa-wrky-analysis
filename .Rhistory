View(pathway.codes)
pathway.codes
grep(outdat$pathway.code[1],x = pathways.list,value = TRUE)
grep("mus04626",x = pathways.list,value = TRUE)
head(pathways.list)
grep("path:mus04626",x = pathways.list,value = TRUE)
stringr::str_extract(pathways.list,"mus04626")
stringr::str_extract(pathways.list,"path:mus04626")
class(pathways.list)
stringr::str_extract(pathways.list,"mus01210")
View(pathways.list)
stringr::str_extract(pathways.list[1],"mus01210")
pathways.list[1]
names(pathways.list)
stringr::str_extract(names(pathways.list),"mus01210")
stringr::str_extract(pathways.list,"mus01210")
View(data.frame(pathways.list))
outdat$pathway.name <- data.frame(pathways.list)[outdat$pathway.code]
outdat$pathway.name <- data.frame(pathways.list)[,outdat$pathway.code]
subset(data.frame(pathways.list),row.names(data.frame(pathways.list)) %in% outdat$pathway.code))
subset(data.frame(pathways.list),row.names(data.frame(pathways.list)) %in% outdat$pathway.code)
outdat$pathway.name <- subset(data.frame(pathways.list),row.names(data.frame(pathways.list)) %in% paste("path:",outdat$pathway.code,sep=""))
pathways.list.df <- data.frame(pathways.list,id=names(pathways.list))
View(pathways.list.df)
rownames(pathways.list.df) <- NULL
outdat$pathway.name <- subset(pathways.list.df,id %in% paste("path:",outdat$pathway.code,sep=""))
View(outdat)
paste("path:",outdat$pathway.code,sep="")
pathways.list.df$id[,paste("path:",outdat$pathway.code,sep="")]
pathways.list.df$id[paste("path:",outdat$pathway.code,sep=""),]
View(outdat)
outdat <- data.frame(pathway.code = rownames(pVals.by.pathway))
#outdat$pathway.name <- pathways.list.df$id[,paste("path:",outdat$pathway.code,sep="")]
outdat$p.value <- pVals.by.pathway[,"p.value"]
outdat$Annotated <- pVals.by.pathway[,"Annotated"]
outdat <- outdat[order(outdat$p.value),]
head(outdat)
View(outdat)
outdat <- outdat[order(outdat$p.value),] %>% filter(Annotated == 0)
View(outdat)
# Assemble output table
outdat <- data.frame(pathway.code = rownames(pVals.by.pathway))
#outdat$pathway.name <- pathways.list.df$id[,paste("path:",outdat$pathway.code,sep="")]
outdat$p.value <- pVals.by.pathway[,"p.value"]
outdat$Annotated <- pVals.by.pathway[,"Annotated"]
outdat <- outdat[order(outdat$p.value),] %>% filter(Annotated > 0)
pathways.list.df <- data.frame(pathways.list,id=sub("path:", "", names(pathways.list)))
rownames(pathways.list.df) <- NULL
outdat <- data.frame(pathway.code = rownames(pVals.by.pathway))
outdat$pathway.name <- pathways.list.df[outdat$pathway.code]
# Assemble output table
outdat <- data.frame(pathway.code = rownames(pVals.by.pathway))
outdat$p.value <- pVals.by.pathway[,"p.value"]
outdat$Annotated <- pVals.by.pathway[,"Annotated"]
outdat <- outdat[order(outdat$p.value),] %>% filter(Annotated > 0)
outdat$pathway.name <- pathways.list.df$id[outdat$pathway.code]
head(outdat)
outdat$pathway.name <- filter(pathways.list.df,id %in% outdat$pathway.code) %>% select(pathways.list)
head(outdat)
View(outdat)
filter(pathways.list.df,id %in% outdat$pathway.code) %>% select(pathways.list)
merge(pathways.list.df,outdat,by.x=id,by.y=pathway.code,all.y=TRUE)
outdat$pathway.name <- merge(pathways.list.df,outdat,by.x="id",by.y="pathway.code",all.y=TRUE)
View(outdat)
outdat <- merge(pathways.list.df,outdat,by.x="id",by.y="pathway.code",all.y=TRUE)
View(outdat)
# Assemble output table
outdat <- data.frame(pathway.code = rownames(pVals.by.pathway))
outdat$p.value <- pVals.by.pathway[,"p.value"]
outdat$Annotated <- pVals.by.pathway[,"Annotated"]
outdat <- outdat[order(outdat$p.value),] %>% filter(Annotated > 0)
outdat <- merge(pathways.list.df,outdat,by.x="id",by.y="pathway.code")
head(outdat)
View(outdat)
outdat <- merge(pathways.list.df,outdat,by.x="id",by.y="pathway.code") %>% arrange(desc(Annotated))
# Assemble output table
outdat <- data.frame(pathway.code = rownames(pVals.by.pathway))
outdat$p.value <- pVals.by.pathway[,"p.value"]
outdat$Annotated <- pVals.by.pathway[,"Annotated"]
outdat <- outdat[order(outdat$p.value),] %>% filter(Annotated > 0)
outdat <- merge(pathways.list.df,outdat,by.x="id",by.y="pathway.code") %>% arrange(desc(Annotated))
head(outdat)
hmap_dat <- merge(siggenes_1[,c(1,2,7)],siggenes_2[,c(1,2,7)],by = c("Row.names","name"),all=TRUE) %>% replace(is.na(.),0)
rownames(hmap_dat) <- hmap_dat$Row.names
colnames(hmap_dat) <- c("gene_id","annotation","Untreated_vs_1DPI","Untreated_vs_14DPI")
musa_go_annot <- read.delim("D:/DropboxBackup/musa-meth-v2/Gene-dist-cat/blast2go_go_table_20160717_2017.txt",header = TRUE)
hmap_dat_annot <- merge(musa_go_annot[,c(1,8)],hmap_dat,by.x = "SeqName",by.y="gene_id",all.y=TRUE) %>%
mutate(BP = stringr::str_extract(GO.Names.list,"response to stress|signal transduction|generation of precursor metabolites and energy|carbohydrate metabolic process|response to abiotic stimulus"),
MF = stringr::str_extract(GO.Names.list,"transcription factor activity|catalytic activity| protein binding"),
CC =  stringr::str_extract(GO.Names.list,"cell wall|cytoplasm|intracellular membrane-bounded organelle|membrane"))
rownames(hmap_dat_annot) <- hmap_dat_annot$SeqName
# write.table(go_annot_count,file = "D:/musa-wrky-study/cov/DE-genes-GOcount.tsv",sep = "\t",row.names = FALSE,col.names = FALSE,quote = FALSE)
go_annot_count <- hmap_dat_annot[,c(1,6,7,8)] %>% reshape2::melt(id.vars = c("SeqName")) %>%  dplyr::group_by(value,variable) %>% dplyr::summarise(count=n(),toString(SeqName)) %>% tidyr::drop_na() %>% arrange(variable)
colnames(go_annot_count) <- c("GOterm","category","count","Genes")
go_annot_count %>% ggbarplot("GOterm","count",color = "category",fill="category",label = TRUE, label.pos = "out",palette = "jco") + theme(axis.text.x = element_text(angle = 80, hjust = 1))
kable(outdat)
kable(outdat,format = "html",align = 'c') %>% kable_styling(bootstrap_options = 'striped', full_width = F) %>% scroll_box(width = "100%", height = "550px")
pVals.by.pathway <- t(sapply(names(genes.by.pathway),
function(pathway) {
pathway.genes <- genes.by.pathway[[pathway]]
list.genes.in.pathway <- intersect(names(geneList), pathway.genes)
list.genes.not.in.pathway <- setdiff(names(geneList), list.genes.in.pathway)
scores.in.pathway <- geneList[list.genes.in.pathway]
scores.not.in.pathway <- geneList[list.genes.not.in.pathway]
if (length(scores.in.pathway) > 0){
p.value <- wilcox.test(scores.in.pathway, scores.not.in.pathway, alternative = "less")$p.value
} else{
p.value <- NA
}
return(c(p.value = p.value, Annotated = length(list.genes.in.pathway) , gene = list.genes.in.pathway))
}
))
pVals.by.pathway[,"gene"]
pVals.by.pathway["gene"]
pVals.by.pathway
geneList <- DE_geneid$PValue
names(geneList) <- DE_geneid$ncbi_gene_id
pVals.by.pathway <- t(sapply(names(genes.by.pathway),
function(pathway) {
pathway.genes <- genes.by.pathway[[pathway]]
list.genes.in.pathway <- intersect(names(geneList), pathway.genes)
list.genes.not.in.pathway <- setdiff(names(geneList), list.genes.in.pathway)
scores.in.pathway <- geneList[list.genes.in.pathway]
scores.not.in.pathway <- geneList[list.genes.not.in.pathway]
if (length(scores.in.pathway) > 0){
p.value <- wilcox.test(scores.in.pathway, scores.not.in.pathway, alternative = "less")$p.value
} else{
p.value <- NA
}
return(c(p.value = p.value, Annotated = length(list.genes.in.pathway) , genelist = toString(list.genes.in.pathway)))
}
))
View(pVals.by.pathway)
# Assemble output table
outdat <- data.frame(pathway.code = rownames(pVals.by.pathway))
outdat$p.value <- pVals.by.pathway[,"p.value"]
outdat$Annotated <- pVals.by.pathway[,"Annotated"]
outdat$genelist <- pVals.by.pathway[,"genelist"]
outdat <- outdat[order(outdat$p.value),] %>% filter(Annotated > 0)
outdat <- merge(pathways.list.df,outdat,by.x="id",by.y="pathway.code") %>% arrange(desc(Annotated))
kable(outdat,format = "html",align = 'c') %>% kable_styling(bootstrap_options = 'striped', full_width = F) %>% scroll_box(width = "100%", height = "550px")
View(DE_geneid)
View(DE_pval)
View(DE_geneid)
DE_geneid <- merge(DE_pval,musa_gene_id,by.x="Row.names",by.y="gene",all.x= TRUE)
View(DE_geneid)
DE_geneid <- merge(DE_pval,musa_gene_id,by.x="Row.names",by.y="gene",all.x= TRUE)  %>% tidyr::drop_na()
DE_pval <- merge(siggenes_1[,c(1,4,6)],siggenes_2[,c(1,4,6)],by = c("Row.names","PValue","comparison","name"),all=TRUE) %>% replace(is.na(.),0)
View(DE_pval)
DE_pval <- merge(siggenes_1[,c(1,4,6,7)],siggenes_2[,c(1,4,6,7)],by = c("Row.names","PValue","comparison","name"),all=TRUE) %>% replace(is.na(.),0)
DE_geneid <- merge(DE_pval,musa_gene_id,by.x="Row.names",by.y="gene",all.x= TRUE)  %>% tidyr::drop_na()
kable(DE_geneid,format = "html",align = 'c') %>% kable_styling(bootstrap_options = 'striped', full_width = F) %>% scroll_box(width = "100%", height = "550px")
kable(outdat,format = "html",align = 'c') %>% kable_styling(bootstrap_options = 'striped', full_width = F) %>% scroll_box(width = "100%", height = "550px")
View(hmap_dat_annot)
View(hmap_dat)
View(hmap_dat_annot)
knitr::opts_chunk$set(echo = TRUE)
library(Biostrings)
library(ggpubr)
library(ComplexHeatmap)
library(circlize)
library(edgeR)
library(dplyr)
library(knitr)
library(kableExtra)
hmap_dat_annot %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI,BP) %>% filter(BP =="response to stress") %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI) %>% as.matrix() %>%
Heatmap(cluster_columns = FALSE,cluster_rows = TRUE,name="Log Fold Changes",
clustering_method_rows = "ward.D",clustering_method_columns = "ward.D",
clustering_distance_rows = "euclidean",clustering_distance_columns = "euclidean",
row_names_side="right",row_names_gp=gpar(fontsize=8),
rect_gp = gpar(col = "black", lwd = 0.5),
show_column_names = TRUE,column_names_gp=gpar(fontsize=12),
row_dend_side = "left", show_row_names = TRUE,column_title = "Response to stress")
<- hmap_dat_annot %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI,BP) %>% filter(BP =="response to stress" & BP == "response to abiotic stimulus
hmap_dat_annot %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI,BP) %>% filter(BP =="response to stress" & BP == "response to abiotic stimulus
") %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI) %>% as.matrix() %>%
Heatmap(cluster_columns = FALSE,cluster_rows = TRUE,name="Log Fold Changes",
clustering_method_rows = "ward.D",clustering_method_columns = "ward.D",
clustering_distance_rows = "euclidean",clustering_distance_columns = "euclidean",
row_names_side="right",row_names_gp=gpar(fontsize=8),
rect_gp = gpar(col = "black", lwd = 0.5),
show_column_names = TRUE,column_names_gp=gpar(fontsize=12),
row_dend_side = "left", show_row_names = TRUE,column_title = "Response to stress")
hmap_dat_annot %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI,BP) %>% filter(BP =="response to stress|response to abiotic stimulus") %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI) %>% as.matrix() %>%
Heatmap(cluster_columns = FALSE,cluster_rows = TRUE,name="Log Fold Changes",
clustering_method_rows = "ward.D",clustering_method_columns = "ward.D",
clustering_distance_rows = "euclidean",clustering_distance_columns = "euclidean",
row_names_side="right",row_names_gp=gpar(fontsize=8),
rect_gp = gpar(col = "black", lwd = 0.5),
show_column_names = TRUE,column_names_gp=gpar(fontsize=12),
row_dend_side = "left", show_row_names = TRUE,column_title = "Response to stress")
hmap_dat_annot %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI,BP) %>% filter(grepl("response",BP)) %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI) %>% as.matrix() %>%
Heatmap(cluster_columns = FALSE,cluster_rows = TRUE,name="Log Fold Changes",
clustering_method_rows = "ward.D",clustering_method_columns = "ward.D",
clustering_distance_rows = "euclidean",clustering_distance_columns = "euclidean",
row_names_side="right",row_names_gp=gpar(fontsize=8),
rect_gp = gpar(col = "black", lwd = 0.5),
show_column_names = TRUE,column_names_gp=gpar(fontsize=12),
row_dend_side = "left", show_row_names = TRUE,column_title = "Response to stress")
hmap_dat_annot %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI,BP) %>% filter(grepl("activity",MF)) %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI) %>% as.matrix() %>%
Heatmap(cluster_columns = FALSE,cluster_rows = TRUE,name="Log Fold Changes",
clustering_method_rows = "ward.D",clustering_method_columns = "ward.D",
clustering_distance_rows = "euclidean",clustering_distance_columns = "euclidean",
row_names_side="right",row_names_gp=gpar(fontsize=8),
rect_gp = gpar(col = "black", lwd = 0.5),
show_column_names = TRUE,column_names_gp=gpar(fontsize=12),
row_dend_side = "left", show_row_names = TRUE,column_title = "Catalytic activity & transcription factor activity")
hmap_dat_annot %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI,MF) %>% filter(grepl("activity",MF)) %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI) %>% as.matrix() %>%
Heatmap(cluster_columns = FALSE,cluster_rows = TRUE,name="Log Fold Changes",
clustering_method_rows = "ward.D",clustering_method_columns = "ward.D",
clustering_distance_rows = "euclidean",clustering_distance_columns = "euclidean",
row_names_side="right",row_names_gp=gpar(fontsize=8),
rect_gp = gpar(col = "black", lwd = 0.5),
show_column_names = TRUE,column_names_gp=gpar(fontsize=12),
row_dend_side = "left", show_row_names = TRUE,column_title = "Catalytic activity & transcription factor activity")
ht_list = h1 + h2
h1 <- hmap_dat_annot %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI,BP) %>% filter(grepl("response",BP)) %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI) %>% as.matrix() %>%
Heatmap(cluster_columns = FALSE,cluster_rows = TRUE,name="Log Fold Changes",
clustering_method_rows = "ward.D",clustering_method_columns = "ward.D",
clustering_distance_rows = "euclidean",clustering_distance_columns = "euclidean",
row_names_side="right",row_names_gp=gpar(fontsize=8),
rect_gp = gpar(col = "black", lwd = 0.5),
show_column_names = TRUE,column_names_gp=gpar(fontsize=12),
row_dend_side = "left", show_row_names = TRUE,column_title = "Response to stress")
h2 <- hmap_dat_annot %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI,MF) %>% filter(grepl("activity",MF)) %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI) %>% as.matrix() %>%
Heatmap(cluster_columns = FALSE,cluster_rows = TRUE,name="Log Fold Changes",
clustering_method_rows = "ward.D",clustering_method_columns = "ward.D",
clustering_distance_rows = "euclidean",clustering_distance_columns = "euclidean",
row_names_side="right",row_names_gp=gpar(fontsize=8),
rect_gp = gpar(col = "black", lwd = 0.5),
show_column_names = TRUE,column_names_gp=gpar(fontsize=12),
row_dend_side = "left", show_row_names = TRUE,column_title = "Catalytic activity & transcription factor activity")
ht_list = h1 + h2
hmap_dat_annot %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI,MF) %>% filter(grepl("activity",MF)) %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI) %>% as.matrix() %>%
Heatmap(cluster_columns = FALSE,cluster_rows = TRUE,name="Log Fold Changes",
clustering_method_rows = "ward.D",clustering_method_columns = "ward.D",
clustering_distance_rows = "euclidean",clustering_distance_columns = "euclidean",
row_names_side="right",row_names_gp=gpar(fontsize=8),
rect_gp = gpar(col = "black", lwd = 0.5),
show_column_names = TRUE,column_names_gp=gpar(fontsize=12),
row_dend_side = "left", show_row_names = TRUE,column_title = "Catalytic activity & transcription factor activity")
hmap_dat_annot %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI,MF) %>% filter(grepl("activity",MF)) %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI) %>% as.matrix() %>%
Heatmap(cluster_columns = FALSE,cluster_rows = TRUE,name="Log Fold Changes",
clustering_method_rows = "ward.D",clustering_method_columns = "ward.D",
clustering_distance_rows = "euclidean",clustering_distance_columns = "euclidean",
row_names_side="right",row_names_gp=gpar(fontsize=8),
rect_gp = gpar(col = "black", lwd = 0.5),
show_column_names = TRUE,column_names_gp=gpar(fontsize=12),
row_dend_side = "left", show_row_names = TRUE,column_title = "Catalytic & transcription factor activity")
hmap_dat_annot %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI,MF) %>% filter(grepl("activity",MF)) %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI) %>% as.matrix() %>%
Heatmap(cluster_columns = FALSE,cluster_rows = TRUE,name="Log Fold Changes",
clustering_method_rows = "ward.D",clustering_method_columns = "ward.D",
clustering_distance_rows = "euclidean",clustering_distance_columns = "euclidean",
row_names_side="right",row_names_gp=gpar(fontsize=8),
rect_gp = gpar(col = "black", lwd = 0.5),
show_column_names = TRUE,column_names_gp=gpar(fontsize=12),
row_dend_side = "left", show_row_names = TRUE,column_title = "Catalytic & transcription")
#col = colorRamp2(c(0,5,10,20),c("#EEEEEE","cornflowerblue","yellow","red"),space = "RGB")
ha = rowAnnotation(foo = anno_text(hmap_dat$annotation, location = 0.5, just = "center",gp = gpar(fontsize = 4)))
hmap_dat_annot %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI,BP) %>% filter(grepl("response",BP)) %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI) %>% as.matrix() %>%
Heatmap(cluster_columns = FALSE,cluster_rows = TRUE,name="Log Fold Changes",
clustering_method_rows = "ward.D",clustering_method_columns = "ward.D",
clustering_distance_rows = "euclidean",clustering_distance_columns = "euclidean",
row_names_side="right",row_names_gp=gpar(fontsize=8),
rect_gp = gpar(col = "black", lwd = 0.5),
show_column_names = TRUE,column_names_gp=gpar(fontsize=12),
row_dend_side = "left", show_row_names = TRUE,column_title = "Response to stress")
hmap_dat_annot %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI,BP) %>% filter(grepl("carbohydrate",BP)) %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI) %>% as.matrix() %>%
Heatmap(cluster_columns = FALSE,cluster_rows = TRUE,name="Log Fold Changes",
clustering_method_rows = "ward.D",clustering_method_columns = "ward.D",
clustering_distance_rows = "euclidean",clustering_distance_columns = "euclidean",
row_names_side="right",row_names_gp=gpar(fontsize=8),
rect_gp = gpar(col = "black", lwd = 0.5),
show_column_names = TRUE,column_names_gp=gpar(fontsize=12),
row_dend_side = "left", show_row_names = TRUE,column_title = "Response to stress")
ha1 <- hmap_dat_annot %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI,BP,annotation) %>% filter(grepl("response",BP))  %>%
rowAnnotation(Annotation = anno_text(annotation, location = 0.5, just = "center",gp = gpar(fontsize = 4)))
hmap_dat_annot %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI,BP,annotation) %>% filter(grepl("response",BP))
ha1 <- hmap_dat_annot %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI,BP,annotation) %>% filter(grepl("response",BP))  %>% select(annotation) %>% rowAnnotation(Annotation = anno_text(annotation, location = 0.5, just = "center",gp = gpar(fontsize = 4)))
hmap_dat_annot %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI,BP,annotation) %>% filter(grepl("response",BP))  %>% select(annotation)
hmap_dat_annot %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI,BP,annotation) %>% filter(grepl("response",BP))  %>% select(annotation) %>% rowAnnotation(Annot = anno_text(annotation, location = 0.5, just = "center",gp = gpar(fontsize = 4)))
ha1 <- hmap_dat_annot %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI,BP,annotation) %>% filter(grepl("response",BP))  %>% select(annotation)
ha <- rowAnnotation(Annot = anno_text(ha1$annotation, location = 0.5, just = "center",gp = gpar(fontsize = 4)))
hmap_dat_annot %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI,BP) %>% filter(grepl("response",BP)) %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI) %>% as.matrix() %>%
Heatmap(cluster_columns = FALSE,cluster_rows = TRUE,name="Log Fold Changes",
clustering_method_rows = "ward.D",clustering_method_columns = "ward.D",
clustering_distance_rows = "euclidean",clustering_distance_columns = "euclidean",
row_names_side="right",row_names_gp=gpar(fontsize=8),
rect_gp = gpar(col = "black", lwd = 0.5),right_annotation = ha,
show_column_names = TRUE,column_names_gp=gpar(fontsize=12),
row_dend_side = "left", show_row_names = TRUE,column_title = "Response to stress")
hmap_dat_annot %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI,BP) %>% filter(grepl("response",BP)) %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI) %>% as.matrix() %>%
Heatmap(cluster_columns = FALSE,cluster_rows = TRUE,name="Log Fold Changes",
clustering_method_rows = "ward.D",clustering_method_columns = "ward.D",
clustering_distance_rows = "euclidean",clustering_distance_columns = "euclidean",
row_names_side="right",row_names_gp=gpar(fontsize=8),
rect_gp = gpar(col = "black", lwd = 0.5),right_annotation = ha,
show_column_names = TRUE,column_names_gp=gpar(fontsize=12),
row_dend_side = "left", show_row_names = TRUE,column_title = "Response to stress")
#col = colorRamp2(c(0,5,10,20),c("#EEEEEE","cornflowerblue","yellow","red"),space = "RGB")
ha1 <- hmap_dat_annot %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI,BP,annotation) %>% filter(grepl("response",BP))  %>% select(annotation)
ha <- rowAnnotation(Annot = anno_text(ha1$annotation, location = 0.5, just = "center",gp = gpar(fontsize = 4)))
hmap_dat_annot %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI,BP) %>% filter(grepl("response",BP)) %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI) %>% as.matrix() %>%
Heatmap(cluster_columns = FALSE,cluster_rows = TRUE,name="Log Fold Changes",
clustering_method_rows = "ward.D",clustering_method_columns = "ward.D",
clustering_distance_rows = "euclidean",clustering_distance_columns = "euclidean",
row_names_side="right",row_names_gp=gpar(fontsize=8),
rect_gp = gpar(col = "black", lwd = 0.5),right_annotation = ha,
show_column_names = TRUE,column_names_gp=gpar(fontsize=12),
row_dend_side = "left", show_row_names = TRUE,column_title = "Response to stress")
#col = colorRamp2(c(0,5,10,20),c("#EEEEEE","cornflowerblue","yellow","red"),space = "RGB")
ha1 <- hmap_dat_annot %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI,BP,annotation) %>% filter(grepl("response",BP))  %>% select(annotation)
ha <- rowAnnotation(Annot = anno_text(ha1$annotation, location = 0.5, just = "center",gp = gpar(fontsize = 6)))
hmap_dat_annot %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI,BP) %>% filter(grepl("response",BP)) %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI) %>% as.matrix() %>%
Heatmap(cluster_columns = FALSE,cluster_rows = TRUE,name="Log Fold Changes",
clustering_method_rows = "ward.D",clustering_method_columns = "ward.D",
clustering_distance_rows = "euclidean",clustering_distance_columns = "euclidean",
row_names_side="right",row_names_gp=gpar(fontsize=8),
rect_gp = gpar(col = "black", lwd = 0.5),right_annotation = ha,
show_column_names = TRUE,column_names_gp=gpar(fontsize=12),
row_dend_side = "left", show_row_names = TRUE,column_title = "Response to stress")
#col = colorRamp2(c(0,5,10,20),c("#EEEEEE","cornflowerblue","yellow","red"),space = "RGB")
ha1 <- hmap_dat_annot %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI,BP,annotation) %>% filter(grepl("response",BP))  %>% select(annotation)
ha <- rowAnnotation(Annot = anno_text(ha1$annotation, location = 0.5, just = "center",gp = gpar(fontsize = 6)))
hmap_dat_annot %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI,BP) %>% filter(grepl("response",BP)) %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI) %>% as.matrix() %>%
Heatmap(cluster_columns = FALSE,cluster_rows = TRUE,name="Log Fold Changes",
clustering_method_rows = "ward.D",clustering_method_columns = "ward.D",
clustering_distance_rows = "euclidean",clustering_distance_columns = "euclidean",
row_names_side="right",row_names_gp=gpar(fontsize=8),
rect_gp = gpar(col = "black", lwd = 0.5),right_annotation = ha,
show_column_names = TRUE,column_names_gp=gpar(fontsize=12),
row_dend_side = "left", show_row_names = TRUE,column_title = "Response to stress")
#col = colorRamp2(c(0,5,10,20),c("#EEEEEE","cornflowerblue","yellow","red"),space = "RGB")
ha1 <- hmap_dat_annot %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI,BP,annotation) %>% filter(grepl("response",BP))  %>% select(annotation)
ha <- rowAnnotation(Annot = anno_text(ha1$annotation, location = 0.5, just = "center",gp = gpar(fontsize = 6)))
hmap_dat_annot %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI,BP) %>% filter(grepl("response",BP)) %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI) %>% as.matrix() %>%
Heatmap(cluster_columns = FALSE,cluster_rows = TRUE,name="Log Fold Changes",
clustering_method_rows = "ward.D",clustering_method_columns = "ward.D",
clustering_distance_rows = "euclidean",clustering_distance_columns = "euclidean",
row_names_side="right",row_names_gp=gpar(fontsize=8),
rect_gp = gpar(col = "black", lwd = 0.5),right_annotation = ha,
show_column_names = TRUE,column_names_gp=gpar(fontsize=12),
row_dend_side = "left", show_row_names = TRUE,column_title = "Response to stress")
#col = colorRamp2(c(0,5,10,20),c("#EEEEEE","cornflowerblue","yellow","red"),space = "RGB")
ha1 <- hmap_dat_annot %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI,BP,annotation) %>% filter(grepl("response",BP))  %>% select(annotation)
ha <- rowAnnotation(Annot = anno_text(ha1$annotation, location = 0.5, just = "center",gp = gpar(fontsize = 8)))
hmap_dat_annot %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI,BP) %>% filter(grepl("response",BP)) %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI) %>% as.matrix() %>%
Heatmap(cluster_columns = FALSE,cluster_rows = TRUE,name="Log Fold Changes",
clustering_method_rows = "ward.D",clustering_method_columns = "ward.D",
clustering_distance_rows = "euclidean",clustering_distance_columns = "euclidean",
row_names_side="right",row_names_gp=gpar(fontsize=8),
rect_gp = gpar(col = "black", lwd = 0.5),right_annotation = ha,
show_column_names = TRUE,column_names_gp=gpar(fontsize=12),
row_dend_side = "left", show_row_names = TRUE,column_title = "Response to stress")
#col = colorRamp2(c(0,5,10,20),c("#EEEEEE","cornflowerblue","yellow","red"),space = "RGB")
ha1 <- hmap_dat_annot %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI,BP,annotation) %>% filter(grepl("response",BP))  %>% select(annotation)
ha <- rowAnnotation(Annot = anno_text(ha1$annotation, location = 0.5, just = "center",gp = gpar(fontsize = 8)))
hmap_dat_annot %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI,BP) %>% filter(grepl("response",BP)) %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI) %>% as.matrix() %>%
Heatmap(cluster_columns = FALSE,cluster_rows = TRUE,name="Log Fold Changes",
clustering_method_rows = "ward.D",clustering_method_columns = "ward.D",
clustering_distance_rows = "euclidean",clustering_distance_columns = "euclidean",
row_names_side="right",row_names_gp=gpar(fontsize=8),
rect_gp = gpar(col = "black", lwd = 0.5),right_annotation = ha,
show_column_names = TRUE,column_names_gp=gpar(fontsize=12),
row_dend_side = "left", show_row_names = TRUE,column_title = "Response to stress")
ha1 <- hmap_dat_annot %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI,BP,annotation) %>% filter(grepl("carbohydrate",BP))  %>% select(annotation)
ha <- rowAnnotation(Annot = anno_text(ha1$annotation, location = 0.5, just = "center",gp = gpar(fontsize = 8)))
hmap_dat_annot %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI,BP) %>% filter(grepl("carbohydrate",BP)) %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI) %>% as.matrix() %>%
Heatmap(cluster_columns = FALSE,cluster_rows = TRUE,name="Log Fold Changes",
clustering_method_rows = "ward.D",clustering_method_columns = "ward.D",
clustering_distance_rows = "euclidean",clustering_distance_columns = "euclidean",
row_names_side="right",row_names_gp=gpar(fontsize=8),
rect_gp = gpar(col = "black", lwd = 0.5),right_annotation = ha,
show_column_names = TRUE,column_names_gp=gpar(fontsize=12),
row_dend_side = "left", show_row_names = TRUE,column_title = "Response to stress")
ha1 <- hmap_dat_annot %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI,BP,annotation) %>% filter(grepl("carbohydrate",BP))  %>% select(annotation)
ha <- rowAnnotation(Annot = anno_text(ha1$annotation, location = 0.5, just = "center",gp = gpar(fontsize = 8)))
hmap_dat_annot %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI,BP) %>% filter(grepl("carbohydrate",BP)) %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI) %>% as.matrix() %>%
Heatmap(cluster_columns = FALSE,cluster_rows = TRUE,name="Log Fold Changes",
clustering_method_rows = "ward.D",clustering_method_columns = "ward.D",
clustering_distance_rows = "euclidean",clustering_distance_columns = "euclidean",
row_names_side="right",row_names_gp=gpar(fontsize=8),
rect_gp = gpar(col = "black", lwd = 0.5),right_annotation = ha,
show_column_names = TRUE,column_names_gp=gpar(fontsize=12),
row_dend_side = "left", show_row_names = TRUE,column_title = "Response to stress")
ha1 <- hmap_dat_annot %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI,BP,annotation) %>% filter(grepl("carbohydrate",BP))  %>% select(annotation)
ha <- rowAnnotation(Annot = anno_text(ha1$annotation, location = 0.5, just = "center",gp = gpar(fontsize = 8)))
hmap_dat_annot %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI,BP) %>% filter(grepl("carbohydrate",BP)) %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI) %>% as.matrix() %>%
Heatmap(cluster_columns = FALSE,cluster_rows = TRUE,name="Log Fold Changes",
clustering_method_rows = "ward.D",clustering_method_columns = "ward.D",
clustering_distance_rows = "euclidean",clustering_distance_columns = "euclidean",
row_names_side="right",row_names_gp=gpar(fontsize=8),
rect_gp = gpar(col = "black", lwd = 0.5),right_annotation = ha,
show_column_names = TRUE,column_names_gp=gpar(fontsize=12),
row_dend_side = "left", show_row_names = TRUE,column_title = "carbohydrate metabolism")
ha1 <- hmap_dat_annot %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI,MF,annotation) %>% filter(grepl("activity",BP))  %>% select(annotation)
ha1 <- hmap_dat_annot %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI,MF,annotation) %>% filter(grepl("activity",MF))  %>% select(annotation)
ha <- rowAnnotation(Annot = anno_text(ha1$annotation, location = 0.5, just = "center",gp = gpar(fontsize = 8)))
hmap_dat_annot %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI,MF) %>% filter(grepl("activity",MF)) %>% select(Untreated_vs_1DPI,Untreated_vs_14DPI) %>% as.matrix() %>%
Heatmap(cluster_columns = FALSE,cluster_rows = TRUE,name="Log Fold Changes",
clustering_method_rows = "ward.D",clustering_method_columns = "ward.D",
clustering_distance_rows = "euclidean",clustering_distance_columns = "euclidean",
row_names_side="right",row_names_gp=gpar(fontsize=8),
rect_gp = gpar(col = "black", lwd = 0.5),right_annotation = ha,
show_column_names = TRUE,column_names_gp=gpar(fontsize=12),
row_dend_side = "left", show_row_names = TRUE,column_title = "Catalytic & transcription")
write.table(DE_geneid,file = "D:/musa-wrky-study/DEGenes/DE-genes-ncbi.tsv",sep = "\t",row.names = FALSE,col.names = FALSE,quote = FALSE)
write.table(outdat,file = "D:/musa-wrky-study/cov/DE-genes-KEGG-pathway.tsv",sep = "\t",row.names = FALSE,col.names = FALSE,quote = FALSE)
write.table(DE_geneid,file = "D:/musa-wrky-study/DEGenes/DE-genes-ncbi.tsv",sep = "\t",row.names = FALSE,col.names = TRUE,quote = FALSE)
write.table(outdat,file = "D:/musa-wrky-study/DEGenes/DE-genes-KEGG-pathway.tsv",sep = "\t",row.names = FALSE,col.names = TRUE,quote = FALSE)
col = colorRamp2(c(0,5,15,30),c("#EEEEEE","cornflowerblue","yellow","red"),space = "RGB")
ha <- rowAnnotation(LogFC = anno_barplot(siggenes_2$logFC, axis = TRUE),
width = unit(c(2,2,2), "cm"),
show_legend = TRUE,
show_annotation_name = TRUE,
annotation_name_offset = unit(4, "mm"),
annotation_name_rot = c(0, 0, 0))
as.matrix(subset(norm_data[,-2],row.names(norm_data) %in% c(siggenes_2$Row.names))) %>%
Heatmap(cluster_columns = FALSE,cluster_rows = TRUE,name="Normalized Counts",
clustering_method_rows = "ward.D",clustering_method_columns = "ward.D",
clustering_distance_rows = "euclidean",clustering_distance_columns = "euclidean",
row_names_side="right",row_names_gp=gpar(fontsize=8),right_annotation = ha,
show_column_names = TRUE,column_names_gp=gpar(fontsize=12),
row_dend_side = "left", show_row_names = TRUE,col=col)
View(hmap_dat_annot)
View(outdat)
View(cov_bed_dat)
View(cov_bed)
cov_bed_dat <- data.frame(cov_bed[,c(4:6)],row.names = cov_bed$geneid)
head(cov_bed_dat)
sampleinfo <- data.frame("condition"=colnames(cov_bed[4:6]),row.names =  colnames(cov_bed_dat))
head(sampleinfo)
dgeFull <- DGEList(cov_bed_dat, group=sampleinfo$condition)
dgeFull
pseudoCounts <- log2(dgeFull$counts+1)
head(pseudoCounts)
boxplot(pseudoCounts, col="gray", las=3)
library(KEGGREST)
#pathways.list <- keggList("pathway", "mus")
head(pathways.list)
pathway.codes <- sub("path:", "", names(pathways.list))
genes.by.pathway <- sapply(pathway.codes,
function(pwid){
pw <- keggGet(pwid)
if (is.null(pw[[1]]$GENE)) return(NA)
pw2 <- pw[[1]]$GENE[c(TRUE,FALSE)] # may need to modify this to c(FALSE, TRUE) for other organisms
pw2 <- unlist(lapply(strsplit(pw2, split = ";", fixed = T), function(x)x[1]))
return(pw2)
}
)
knitr::knit("musa-wrky-analysis-v01.rmd")
knitr::opts_chunk$set(echo = TRUE)
library(Biostrings)
library(ggpubr)
library(ComplexHeatmap)
library(circlize)
library(edgeR)
library(dplyr)
library(knitr)
library(kableExtra)
musa_genes <- readDNAStringSet("D:/musa-wrky-study/ref/musa_acuminata_v2_gene.fna")
cat(paste("Number of genes:", length(musa_genes)," ...\n",sep = ""))
gene_bed <- data.frame("id"=stringr::str_extract(names(musa_genes),"\\Ma\\S+"),"start" = 1,"end" = width(musa_genes))
gene_annot <-data.frame("id"=stringr::str_extract(names(musa_genes),"\\Ma\\S+"),
"name" = stringr::str_extract(names(musa_genes),"\\s+.*"))
#writeXStringSet(musa_cdna_wrky_fa,filepath = "D:/musa-wrky-study/ref/musa_cdna_wrky.fna",format = "fasta")
#
# write.table(gene_bed,file = "D:/musa-wrky-study/ref/musa_genes_v2.bed",sep = "\t",row.names = FALSE,col.names = FALSE,quote = FALSE)
cov_bed <- read.delim("D:/musa-wrky-study/cov/musa_all_gene_cov.bed",sep = "\t",header = FALSE)
colnames(cov_bed) <- c("geneid","start","end","Untreat","1DPI","14DPI")
my_comparisons <- list(c("Untreat","1DPI"),c("Untreat","14DPI"))
cov_bed[,c(1,4:6)] %>%
reshape2::melt() %>%
ggboxplot(x = "variable",y="value",color = "variable",fill = "variable",add = "jitter", shape = "variable") + stat_compare_means(comparisons = my_comparisons)
cov_bed <- read.delim("D:/musa-wrky-study/cov/musa_all_gene_cov.bed",sep = "\t",header = FALSE)
colnames(cov_bed) <- c("geneid","start","end","Untreat","1DPI","14DPI")
my_comparisons <- list(c("Untreat","1DPI"),c("Untreat","14DPI"))
cov_bed[,c(1,4:6)] %>%
reshape2::melt() %>%
ggboxplot(x = "variable",y="value",color = "variable",fill = "variable",add = "jitter", shape = "variable") + stat_compare_means(comparisons = my_comparisons)
knitr::knit("musa-wrky-analysis-v01.rmd")
install.packages("usethis")
install.packages("usethis")
usethis::use_readme_md()
View(cov_bed)
View(outdat)
knitr::opts_chunk$set(echo = TRUE)
library(Biostrings)
install.packages("Biostrings")
library(Biostrings)
knitr::opts_chunk$set(echo = TRUE)
install.packages("knitr")
install.packages("Biostrings")
knitr::opts_chunk$set(echo = TRUE)
library(Biostrings)
install.packages("BioCLite")
install.packages("Rtools")
update.packages()
knitr::opts_chunk$set(echo = TRUE)
library(Biostrings)
install.packages("Biostrings")
install.packages("usethis")
usethis::use_git_config(user.name = "ranga85", user.email = "rnathg@gmail.com")
usethis::create_github_token()
2600000/30
usethis::use_git_config(helper="cache --timeout=2600000")
usethis::use_git_config(helper="cache --timeout=2600000")
credentials::set_github_pat("YourPAT")
credentials::set_github_pat("YourPAT")
usethis::edit_r_environ()
usethis::git_sitrep()
usethis::git_sitrep()
